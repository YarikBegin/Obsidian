[[Объекты]]

Как вы уже догадались, глубокое копирование — это такое дублирование объекта, при котором все его непримитивные свойства тоже копируются.

Логика глубокого копирования неоднозначна, но в общем случае её можно описать так:

1.  создаётся новый пустой объект;
2.  примитивные свойства исходного объекта копируются в этот новый объект;
3.  для каждого из непримитивных свойств исходного объекта выполнить этот алгоритм, начиная с шага 1.

Описывающий эту логику код весьма запутанный, поэтому мы не будем приводить его здесь. Просто опишем примерный алгоритм работы такой программы:

1.  циклом начинаем проходить по всем свойствам объекта;
2.  если встречаем примитивное свойство — копируем;
3.  если встречаем свойство-объект — повторяем для него все шаги, начиная с первого.

Казалось бы, «ура, глубокое копирование выполнено!» Отчасти да, но не всё так просто.

В JavaScript нет встроенного способа глубокого копирования объектов. Чтобы понять, почему, рассмотрим пример:

Скопировать кодJAVASCRIPT

```
const original = {
    one: 1,
    two: 2
};

original.three = original; 
```

Получилось, что свойство `three` объекта `original` — это ссылка на сам объект `original`. Если попробовать глубоко скопировать этот объект, мы придём к бесконечному циклу.

Есть разные техники глубокого копирования и разбирать их все очень долго. Если вам хочется в этом разобраться, в дополнительных материалах есть ссылки на статьи с подробным разбором темы.

Но, скорее всего, прибегать к глубокому копированию придётся нечасто. Ведь вместо этого можно копировать только то, что нужно.

От слов к делу — попробуем выполнить глубокое копирование:

Скопировать кодJAVASCRIPT

```
const original = {
    one: 1,
    two: 2,
    three: { message: 'I love JS' }
};

const copy = Object.assign({}, original);
copy.three = Object.assign({}, original.three);

// копия
console.log(copy);

// { one: 1, two: 2, three: { message: "I love JS" } } 

// копия имеет общие корни с оригиналом?
console.log(copy === original); // false

// свойство three копии имеет общие корни
// со свойством three оригинала?
console.log(copy.three === original.three); // false 
```

Мы записали в свойство `three` объекта `copy` поверхностную копию объекта `original.three`. Вручную скопировав объект на нескольких уровнях, мы чётко определили, что должна содержать копия `copy`, сделали код более понятным и предсказуемым, не прибегая к хитрым способам копирования.