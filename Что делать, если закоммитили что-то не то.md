[[GITHUB]]

Бывает, сделаешь коммит, забыв в него что-то добавить. Бывает, всё ломается. Бывает, в код закралась ошибка, а коммит уже сделан. Гит позволяет справиться со всеми этими ситуациями. В этом уроке мы расскажем, как именно.

## Забыл что-то добавить в коммит `git commit --amend`

Если вы забыли добавить что-то в коммит, необязательно делать новый — можно добавить изменения к старому. Это хорошая практика, потому что не приходится делать новый коммит, который бы «захламлял» историю коммитов.

Чтобы добавить файл в уже сделанный коммит, вызовите команду `git commit --amend`. Попробуйте на примере.

Перейдите в проект `third-project`. Откройте файл `index.html` и добавьте в него несколько элементов: например, `h2`, `p`, `span`. Затем добавьте изменения к последнему коммиту командой `git commit --amend`:

Скопировать кодBASH

```
git add -A
# добавили файлы в stage

git commit --amend 
```

Запуск команды откроет Vim. Он предложит изменить комментарий к последнему коммиту. Нажмите `i`, чтобы начать писать, и введите новый комментарий к коммиту. Как закончите, нажмите `esc`, введите `:wq` и нажмите Enter. Так вы сохраните новый комментарий и выйдете из Vim.

## Всё сломалось

Когда всё перестаёт работать, проще всего откатиться назад — вернуться к последнему коммиту. За это отвечает команда `git reset`.

Есть два способа «вернуться назад»: менее радикальный и более радикальный.

**Менее радикальный способ откатиться: `git reset HEAD`.** Этот подход не затрагивает файлы, с которыми вы работаете. Если файл был изменён или добавлен, но не переведён в staged, сброс изменений этот файл не затронет.

Но файлы, находящиеся в staged, будут оттуда удалены — они будут помечены как неотслеживаемые. Все эти файлы вернутся в то состояние, в котором они пребывали при последнем коммите.

Скопировать кодBASH

```
pwd # проверили, где мы
/Users/students-yandex/Documents/third-project

touch index2.html # создали ненужный файл
git add -A # добавили его в staged

git status # проверили статус

On branch main
Changes to be committed:
  (use "git reset HEAD <file>..." to unstage)

  new file:   index2.html
# файлы попали в staged — всё идёт по плану

git reset HEAD # сбросили до последнего коммита «менее радикальным способом»
git status # проверили статус

On branch main
Untracked files:
  (use "git add <file>..." to include in what will be committed)

  index2.html

nothing added to commit but untracked files present (use "git add" to track)
# файлы из staged попали в рабочую зону 
```

Команда `git reset HEAD` переводит файлы из staged обратно в рабочую зону. Но файлы в рабочей зоне не трогает.

**Более радикальный способ откатиться: `git reset --hard`.** Эта команда удаляет вообще все изменения: и из staged, и из рабочей зоны. После неё вернуть изменения не выйдет.

Команда `git reset --hard` позволяет вернуться к любому коммиту. Для этого после команды указывают номер коммита — первые 7 цифр его хеша.

Скопировать кодBASH

```
git log --oneline

8decgcf (HEAD -> main) Добавил стили
bc73f5f Добавил ещё заголовок # хотим откатиться сюда

git reset --hard bc73f5f
# теперь мы на этом коммите 
```

Коммит `bc73f5f` стал «вершиной»: вся дальнейшая разработка будет идти от него. А старый коммит «отошёл в сторону» — его «Гит» удалит автоматически.

Мы рассмотрели 3 новые команды:

`git commit --amend`, которая добавляет файлы в уже сделанный коммит;

`git reset HEAD`, которая сбрасывает файлы из staged до состояния последнего коммита, но не трогает файлы в рабочей зоне;

`git reset --hard`, которая сбрасывает до состояния любого коммита вообще все файлы.

Эти три команды важны, поскольку позволяют исправлять ошибки. А ошибки не страшно совершать — страшно с ними ничего не делать.