[[JavaScript]]

Модули позволяют работать с системами компьютера из JavaScript. В предыдущих уроках вы создали сервер, импортировав модуль http:

Скопировать кодJAVASCRIPT

```
const http = require('http'); 
```

Http — встроенный модуль Node.js. То, как именно импортировать модуль, прописывают в документации, но обычно достаточно передать имя модуля функции `require`:

Скопировать кодJAVASCRIPT

```
const md5 = require('md5'); 
```

Так устанавливаются пакеты из npm. Но вы можете создавать собственные модули и импортировать в проект. Любой файл c JS-кодом может стать модулем — нужно лишь оформить его по определённым правилам. О них расскажем в этом уроке.

### Как импортировать модули?

Код модуля описывают в отдельном файле, а затем импортируют в точку входа — файл index.js. Создадим файл utils.js в папке проекта и импортируем его в index.js:

Скопировать кодJAVASCRIPT

```
// index.js

const utils = require('./utils'); // Поскольку все модули имеют расширение .js, при импорте его можно опустить и ограничиться названием модуля — utils. 
```

Точка в начале названия модуля означает, что файл нужно искать в той же директории, в которой лежит index.js. Если в папке с проектом нет файла utils.js, движок будет искать папку с именем utils, а в ней — файл index.js.

Также мы можем импортировать модуль из других папок, задав относительный путь:

Скопировать кодJAVASCRIPT

```
const utils = require('../utils'); // две точки означают переход в директорию на уровень выше
const helpers = require('../../helpers'); 
```

### Как экспортировать модули?

Чтобы модули работали, их нужно правильно оформить: показать, какие переменные и функции мы хотим получить снаружи. Для этого важно явно обозначить, что именно экспортируется из модуля.

Это можно сделать с помощью объекта `module.exports`, доступного внутри файла. Всё, что нужно экспортировать, записывают в свойства этого модуля:

Скопировать кодJAVASCRIPT

```
// utils.js

module.exports.someFunction = () => {
  console.log('Меня экспортировали');
};

module.exports.someValue = 42; 
```

Не важно, как именно вы записываете значения в свойства `module.exports`. Такой код тоже сработает:

Скопировать кодJAVASCRIPT

```
// utils.js

const someFunction = () => {
  console.log('Меня экспортировали');
};

const someValue = 42;

module.exports = {
  someFunction,
  someValue
}; 
```

При импорте мы получим объект `module.exports`. Останется только достать из него свойства:

Скопировать кодJAVASCRIPT

```
// index.js

const utils = require('./utils');

const someFunction = utils.someFunction;
const someValue = utils.someValue; 
```

Проще сделать это деструктуризацией:

Скопировать кодJAVASCRIPT

```
// index.js

const { someFunction, someValue } = require('./utils'); 
```

### Как называть модули?

Только строчными буквами. У Node.js есть свой алгоритм кеширования файлов. При этом заглавные и строчные буквы — разные символы для ноды: прописные буквы часто ломают кеширование. Для именования модулей пользуйтесь маленькими буквами.

### ES6 модули работают в ноде?

Да, но только начиная с 12 версии Node.js. Кроме того, чтобы ES6 модули заработали, необходимо, чтобы выполнялись следующие условия:

- все файлы должны иметь расширение `.mjs`.
- или указать специальный флаг `type: module` в файле `package.json`

Скопировать кодBASH

```
# вот так ES6 модули работают
node -experimental-modules index.mjs 
```

Экспорт ES6 модулей выполняется иначе. Необходимо экспортировать каждое нужное значение директивой `export`:

Скопировать кодJAVASCRIPT

```
// test.mjs

export const theme = 'ES6-module';
export const method = (name) => { return `Здравствуйте, ${name}!` }; 
```

При импорте такого модуля мы получим объект с ключами, как у экспортированных переменных.

Скопировать кодJAVASCRIPT

```
// index.js

import { theme, method } from './test'; // из test вернулся объект

console.log(method('Стас Басов')); // "Здравствуйте, Стас Басов!" 
```

ES6-модули по умолчанию работают в строгом режиме, поэтому вам не нужно прописывать `'use strict'`.

Но это не касается node-модулей в целом — они работают в обычном режиме. Так что, если хотите писать код в строгом режиме, не забывайте явно прописывать это директивой `'use strict'` внутри каждого модуля.

С настройкой мы закончили. В следующем уроке опустимся на уровень глубже и разберёмся в устройстве модулей.