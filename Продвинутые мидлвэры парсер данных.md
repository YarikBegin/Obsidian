[[JavaScript]]

В предыдущем уроке вы написали мидлвэр для логирования данных. Но этого не придётся делать часто — для типовых задач уже есть готовые инструменты. Они позволят сэкономить время и не изобретать велосипед. О таких готовых решениях расскажем в уроке.

### Сборка пакетов: body-parser

Как вы помните из предыдущей темы, при передаче между клиентом и сервером данные бьются на блоки, а на принимающей стороне собираются обратно. Тогда мы писали код для сборки пакетов:

Скопировать кодJAVASCRIPT

```
const postForm = (req, res) => {
  let body = ''; // устанавливаем в переменную body пустую строку

  req.on('data', (chunk) => {
    body += chunk; // добавляем каждый приходящий пакет в body
  });

  req.on('end', () => { // когда всё пришло
    // можем работать с объектом из колбэк метода on
  });
}; 
```

Тяжеловато. Особенно для такой базовой задачи как приём данных.

От ненужной сложности нас защищает мидлвэр body-parser. Он самостоятельно объединяет все пакеты, так что мы можем об этом не задумываться:

Скопировать кодJAVASCRIPT

```
const postForm = (req, res) => {
  const { body } = req;
    // затем мы можем просто обращаться к body как к объекту
}; 
```

### Подключим к проекту

Body-parser устанавливают из NPM:

Скопировать кодBASH

```
npm i body-parser 
```

Затем его нужно импортировать:

Скопировать кодJAVASCRIPT

```
// app.js

const bodyParser = require('body-parser'); 
```

Все методы для работы с пакетами находятся в объекте `bodyParser`, остаётся только выбрать нужные: это зависит от типа данных, которые нам приходят.

Скопировать кодJAVASCRIPT

```
app.use(bodyParser.json()); // для собирания JSON-формата
app.use(bodyParser.urlencoded({ extended: true })); // для приёма веб-страниц внутри POST-запроса 
```

Аргументом методу `bodyParser.urlencoded` мы передаём объект опций. `"extended: true"` означает, что данные в полученном объекте `body` могут быть любых типов. При значении `false`, в свойства `body` могут попасть только строки и массивы. Это уже относится к более тонкой настройке, и мы не будем подробно затрагивать эту тему, но оставим ссылку на статью в дополнительных материалах.

Если вам могут прийти данные разных типов, просто задействуйте все нужные методы, — как в примере, Body-parser сам разберётся, какие данные пришли и как их собирать.