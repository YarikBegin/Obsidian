[[Продвинутый JavaScript]]

В одной из прошлых тем мы рассматривали песни как объекты:

Скопировать кодJAVASCRIPT

```
const song1 = {
  title: 'Футбольный мяч',
  artist: 'Антоха MC',
  isLiked: false,
  like: function () {
    song1.isLiked = !song1.isLiked;
  }
};

const song2 = {
  title: 'На заре',
  artist: 'Альянс',
  isLiked: false,
  like: function () {
    song2.isLiked = !song2.isLiked;
  }
};

const song3 = {
  title: 'Ай',
  artist: 'Хаски',
  isLiked: true,
  like: function () {
    song3.isLiked = !song3.isLiked;
  }
}; 
```

Каждый объект хранит функцию `like`: это одна и та же функция, она ставит лайк «своей» песне, то есть меняет свойство `isLiked` объекта, в котором находится. Функция делает одно и то же, но хранится в виде множества копий — по одной для каждого объекта песни. Это нехорошо.

Вы уже умеете сокращать такой код с применением классов, но пока забудьте о них. Скоро вы узнаете, что же на самом деле стоит за классами. Но, чтобы это понять, нужно разобраться с тем, что такое прототип.

### Свойство `__proto__`

У каждого объекта в JS есть свойство `__proto__`. Оно позволяет одному объекту обращаться к свойствам другого.

Работает это так:

-   Вы обращаетесь к свойству объекта, которого у того нет.
-   Движок, не найдя нужного свойства, не прекращает поиски, а заглядывает в свойство `__proto__`: если здесь хранится ссылка на другой объект, движок будет искать нужное свойство у него.

Скопировать кодJAVASCRIPT

```
const obj1 = {
  messageRu: 'Привет, мир!'
};

const obj2 = {
  messageEng: 'Hello, world!'
};

obj2.__proto__ = obj1;

console.log(obj2.messageEng); // "Hello, world!"
console.log(obj2.messageRu); // "Привет, мир!" — свойство messageRu тоже нашлось 
```

Объекты `obj2` и `obj1` связаны ссылкой `__proto__`. В последней строке мы обращаемся к свойству `messageRu`, которого нет в объекте `obj2`. Но движок находит его в объекте `obj1`, переходя по ссылке `__proto__.`

Так можно объединить несколько объектов в цепочку:

Скопировать кодJAVASCRIPT

```
const obj3 = {
  messageRu: 'Привет, мир!'
};

const obj4 = {
  messageEng: 'Hello, world!'
};

const obj5 = {
  messageFrench: 'Bonjour le monde!'
};

obj4.__proto__ = obj3;
obj5.__proto__ = obj4;

console.log(obj5.messageFrench); // "Bonjour le monde!"

console.log(obj5.messageEng); // "Hello, world!" — не нашлось в obj5, но нашлось по ссылке __proto__ в obj4

console.log(obj5.messageRu); // "Привет, мир!" — не нашлось в obj5, не нашлось по ссылке __proto__ в obj4, но нашлось по ссылке obj4.__proto__, то есть в obj3  
```

Процесс поиска свойства в объекте `obj5` будет таким:

![image](https://pictures.s3.yandex.net/resources/sprint_4___1__166_1592649001.jpg)

То, что хранится в свойстве `__proto__` , называют прототип объекта. `obj3` — прототип объекта `obj4`, а тот в свою очередь прототип объекта `obj5`.

> Прототип объекта — это другой объект, где движок будет искать свойство или метод, если их нет в исходном объекте.

Чтобы организовать объекты в цепочку, можно вручную назначить им ссылки `__proto__`, но обычно так не делают. Движок JavaScript не любит такие манёвры и из-за них может работать медленнее. Как правильно задавать объекту прототип, расскажем в следующем уроке.

## Резюме

-   В JavaScript объекты можно организовать в цепочку, для этого есть специальное свойство `__proto__`.
-   Если свойство или метод объекта не найдены в самом объекте, движок ищет их в объекте по ссылке в свойстве `__proto__`.
-   Объект, записанный в `__proto__` называют прототипом того объекта, в котором хранится эта ссылка.