[[JavaScript]]

JavaScript создавали как язык для новичков. Поэтому в нём есть механизмы для исправления ошибок, которые делает разработчик:

Скопировать кодJAVASCRIPT

```
let greeting = 'Привет';

const age = Number(prompt('Введите возраст: ', 0));

if (age > 18) {
  // Опечатались в имени переменной:
  // написали greting вместо greeting
  greting = 'Здравствуйте';
} 
```

Что такое prompt?

Мы опечатались, но если запустить этот код, консоль не покажет ошибку. Движок «догадался», что мы забыли объявить переменную `greting`. Он объявил её самостоятельно в той области видимости, где переменная первый раз упоминается. В глазах JavaScript код стал выглядеть так:

Скопировать кодJAVASCRIPT

```
let greeting = 'Привет';

const age = Number(prompt('Введите возраст: ', 0));

if (age > 18) {
    let greting; // Движок самостоятельно объявил переменную
  greting = 'Здравствуйте';
} 
```

Движок нас неправильно понял: он «подумал», что мы забыли объявить переменную, прежде чем присваивать ей значение. На самом деле мы опечатались. Так что движок оказал нам медвежью услугу: теперь найти ошибку труднее.

В спецификации ES5 появилась возможность отказаться от такой помощи со стороны движка. Для этого нужно писать код в строгом режиме. Чтобы его включить, напишите в начале файла `'use strict'`:

Скопировать кодJAVASCRIPT

```
'use strict';

let greeting = 'Привет';

const age = Number(prompt('Введите возраст: ', 0));

if (age > 18) {
  greting = 'Здравствуйте';
} 
```

Теперь браузер сообщает об ошибке, так что её легко найти и исправить:

![image](https://pictures.s3.yandex.net/resources/greting_1593429463.png)

_Выглядит страшновато, но на самом деле всё просто: greting не определена, — говорит нам браузер_

Строгий режим как бы говорит браузеру выдавать ошибки, на которые тот раньше закрывал глаза.

## Какие изменения несёт строгий режим

В этом уроке расскажем о части отличий строгого режима от обычного. Об остальных поговорим в других уроках темы.

1.  Значение контекста `this`. Вы уже [знаете](https://praktikum.yandex.ru/trainer/web/lesson/1a1651c3-b5b3-4db0-8f42-1ce705395f25/task/abd6a3ae-6cf2-40c9-9ef0-1554e11dad66/) про привязку `this` по умолчанию. В зависимости от наличия строго режима `this` принимает одно из двух значений:
    
    -   `undefined` — в строгом режиме,
    -   `window` — в обычном.
    
    Скопировать кодJAVASCRIPT
    
    ```
     function globalFunction() {
       'use strict';
       console.log(this);
     }
    
     globalFunction(); // undefined — в строгом режиме this по умолчанию undefined
      
    ```
    
    Строгий режим задаёт `this` равным `undefined` для функций, вызванных по имени. Привязку по умолчанию редко используют намеренно — обычно это следствие какой-то ошибки или так называемой потери контекста. О том, что это такое, расскажем в следующем уроке.
    
2.  Если переменная не объявлена, в неё нельзя записать значение:
    
    Скопировать кодJAVASCRIPT
    
    ```
     'use strict';
    
     /* переменную нужно объявить перед записью
     значения в неё, иначе будет ошибка */
    
     greeting = 'Привет'; // ошибка
      
    ```
    
3.  В теме о функциях мы рассказывали о переменной `arguments`: она создаётся внутри функции при объявлении и содержит все переданные аргументы. В обычном режиме мы могли менять значения аргументов, обращаясь к ним по индексам:
    
    Скопировать кодJAVASCRIPT
    
    ```
     function consoleDog(dog) {
       arguments[0] = 'Чихуахуа'; // Перезаписываем аргумент
       console.log(dog);
     }
    
     consoleDog('Джек Рассел'); // "Чихуахуа" — результат изменился
      
    ```
    
    Строгий режим такого не допустит:
    
    Скопировать кодJAVASCRIPT
    
    ```
     'use strict';
    
     function consoleDog(dog) {
       arguments[0] = 'Чихуахуа'; // попытаемся изменить первый аргумент
       console.log(dog);
     }
    
     consoleDog('Джек Рассел'); // "Джек Рассел" — аргумент не перезаписался
      
    ```
    
4.  В строгом режиме параметры функции не могут иметь одинаковые имена — консоль покажет синтаксическую ошибку:
    
    Скопировать кодJAVASCRIPT
    
    ```
     'use strict';
    
     function consoleDog(dog, dog) { // SyntaxError
       console.log(dog);
     }
      
    ```
    

## Как использовать

Если написать `'use strict';` в начале файла, весь его код будет исполняться в строгом режиме:

Скопировать кодJAVASCRIPT

```
/* script.js */

'use strict';

// здесь будет строгий режим

function callMe() {
  // и здесь будет строгий режим
} 
```

Строгий режим можно включить для отдельной функции. Для этого следует написать `'use strict';` в начале тела этой функции:

Скопировать кодJAVASCRIPT

```
function callMe() {
  'use strict';
  
  // здесь будет строгий режим
}

// а здесь нет  
```

Строгий режим нельзя отменить. В языке нет специальной директивы, которая бы выключала его. Единственный способ отключить строгий режим — убрать директиву `'use strict';`.

## Зачем нужен новый режим?

«Медвежьи услуги» движка — это ошибки проектирования. Когда создавали JavaScript, хотели как лучше, а получилось совсем наоборот. Было бы здорово вернуться в прошлое и поменять стандарт. Но сейчас такого сделать уже нельзя.

До того как был придуман строгий режим, разработчики опирались на логику работы обычного. Если сейчас выбросить обычный режим из спецификации, сайты, сделанные по старому стандарту, сломаются. Поэтому нам следует заявлять прямо о желании следовать новому стандарту:

Скопировать кодJAVASCRIPT

```
'use strict'; 
```

Значит ли это, что теперь в начале каждого файла нужно писать `'use strict';`? Нет, так как в прошлом спринте вы начали разбивать код на модули. В модулях строгий режим включён по умолчанию.