[[JavaScript]]

[[Явное преобразование типов]]

JavaScript — язык со слабой типизацией:

-   данные могут менять свой тип, даже если разработчик об этом не просил;
-   невозможно сложить строку с числом, а две строки можно.

Перед вами пример с конкатенацией из прошлого спринта:

Скопировать кодJAVASCRIPT

```
console.log(100 + '500'); // "100500" 
```

При сложении числа со строкой движок превратит число в строку и только потом выполнит конкатенацию.

При попытке сложить строку и число многие языки программирования начинают «ругаться» и показывать ошибки. Но JavaScript такое прощает. Это накладывает дополнительную ответственность на разработчика: нужно следить за поведением переменных. Иначе можно не заметить незапланированное преобразование типа:

Скопировать кодJAVASCRIPT

```
const a = 30; // Количество отжиманий в первом подходе
const b = 10; // Количество отжиманий во втором подходе

console.log('За сегодня вы отжались: ' + a + b + ' раз');

// "За сегодня вы отжались 3010 раз" 
```

Неявное преобразование типа — то, которое происходит без прямого указания разработчика. В JavaScript три вида неявного преобразования типов для примитивных значений:

-   приведение к строке,
-   приведение к числу,
-   приведение к логическому типу.

## Приведение к строке

Неявное преобразование к строчному типу происходит при сложении со строкой:

Скопировать кодJAVASCRIPT

```
1 + ''; // "1"
undefined + ''; // "undefined" 
```

## Приведение к числу

Движок JavaScript приводит данные разных типов к числам, а затем их сравнивает:

Скопировать кодJAVASCRIPT

```
null >= 1; // false
'451' < 452; // true 
```

Оператор «унарный плюс» приводит нечисловые значения после «+» к численному типу. Так `+'33'` вернёт число 33, `+'-77'` вернет число -77. Если операторы сложения и унарный плюс стоят рядом, они не помешают друг другу:

Скопировать кодJAVASCRIPT

```
console.log(67 + +'33'); // 100 
```

Приведение к числу выполнит и любой другой арифметический оператор. Кроме сложения со строкой — оно будет воспринято как конкатенация:

Скопировать кодJAVASCRIPT

```
console.log('3' - 1); // 2 — выполнилось приведение к числу
console.log('4' / 4); // 1 — тоже привелось к числу
console.log('2' * 2); // 4 — опять привелось
console.log('4' + 4); // 44 — а здесь выполнится конкатенация 
```

## Приведение к булевым значениям

В круглых скобках условия `if` любые данные всегда приводятся к логическому типу:

Скопировать кодJAVASCRIPT

```
const usernameElement = document.querySelector('.username');

if (usernameElement) {
  console.log('Привет, ' + usernameElement.textContent);
} 
```

Если элемента с классом `username` на странице нет, в переменную `usernameElement` запишется `null`. В круглых скобках условной конструкции `null` приводится к логическому типу и становится `false`. Поэтому тело условия `if` выполнено не будет.