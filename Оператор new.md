[[Продвинутый JavaScript]]

Вернёмся к функции `createSong`. Она выполняет три действия:

1.  создаёт новый пустой объект с привязанным прототипом;
2.  добавляет этому объекту необходимые свойства;
3.  возвращает этот объект.

Скопировать кодJAVASCRIPT

```
function createSong(title, artist) {
  // 1. Создаём пустой объект с прототипом
  const newSong = Object.create(songPrototype);

  // 2. Добавляем нужные свойства в объект
  newSong.title = title;
  newSong.artist = artist;
  newSong.isLiked = false;

  // 3. Возвращаем объект
  return newSong;
} 
```

Два шага из трёх можно автоматизировать. Мы намеренно этого не делали, чтобы вам было проще понять работу функций-конструкторов.

## Функция-конструктор

Любую функцию в JavaScript можно вызвать с ключевым словом `new` перед вызовом:

Скопировать кодJAVASCRIPT

```
const song = new createSong('На заре', 'Альянс'); 
```

Если движок натыкается на такой вызов, он начинает исполнять код внутри этой функции, но дополняет стандартный процесс исполнения кода двумя шагами (1 и 3 в списке):

1.  Перед тем, как исполнять код, создаёт новый пустой объект и записывает его в значение `this` внутри этой функции.
2.  Исполняет код функции.
3.  Возвращает `this`.

Получается, если функция `createSong` вызвана с оператором `new` от шага создания объекта и его возвращения можно избавиться — эти действия всё равно выполнятся благодаря `new`. Однако в новом объекте не будет прототипного метода `like` — его придётся объявлять отдельно:

Скопировать кодJAVASCRIPT

```
function createSong(title, artist) {
  // this = {}; — движок сделает это сам

  // Добавим в this необходимые свойства
  this.title = title;
  this.artist = artist;
  this.isLiked = false;

  // return this; —  это движок тоже берёт на себя
}

const song = new createSong('На заре', 'Альянс');

console.log(song); 
```

Запустите этот код в консоли, чтобы убедиться, что функция вернула объект со свойствами `title`, `artist` и `isLiked`, которые мы добавили в `this` (хотя вручную мы `this` не возвращали).

![image](https://pictures.s3.yandex.net/resources/JS4_3___1__8_1592649686.jpg)

Функции, предназначенные для того, чтобы их вызывали с оператором `new`, называют функциями-конструкторами. Их основная задача — «сконструировать» какой-то новый объект, в нашем случае объект песни. Отсюда и название.

## Именование функций-конструкторов

Получившийся пример работает, но есть проблема. По имени функции невозможно понять, что её следует вызывать с оператором `new`. Что, если её код написал один разработчик, а пользуется этим кодом другой. Конечно, можно изучить код функции и понять, что это конструктор. Но это долго и сложно, поэтому разработчики придумали способ проще. Функции-конструкторы называют с прописной буквы. Также, функцию-конструктор обычно называют существительным. Отличное имя для нашей функции — `Song`, потому что функция-конструктор создаёт объекты песен:

Скопировать кодJAVASCRIPT

```
function Song(title, artist) {
  this.title = title;
  this.artist = artist;
  this.isLiked = false;
}

const song = new Song('На заре', 'Альянс');

console.log(song); 
```

Для движка имя функции роли не играет: ему неважно, назовём мы её с заглавной буквы или со строчной. Именование функции с прописной не делает её конструктором. Но вы говорите другим разработчикам, что эту функцию следует вызывать как конструктор, то есть с оператором `new`.