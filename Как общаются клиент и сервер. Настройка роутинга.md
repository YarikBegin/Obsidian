[[JavaScript]]

В предыдущем уроке вы создали сервер фреймворком express. Это круто, только пока он не работает: при запуске всплывает сообщение "Cannot GET /".

В этом уроке разберём настройки роутинга. Так сервер сможет отдавать веб-страницы и принимать данные от пользователя. В общем, делаем всё то же, что в первой теме, но вместо чистой ноды воспользуемся экспрессом.

Начнём с обработки GET-запроса, а запросы других типов рассмотрим чуть позже.

### Роутинг GET-запроса

Для обработки GET-запроса в экспрессе есть метод `get`. Он принимает на вход два аргумента:

- строку с запросом;
- колбэк, предписывающий, что нужно делать, если такой запрос пришёл на сервер.

Скопировать кодJAVASCRIPT

```
app.get('/', (req, res) => {
    // логика обработки запроса
}); 
```

Параметры колбэка — объекты запроса и ответа.

### Объект ответа

У объекта ответа есть метод `send` — он отправляет ответ. Параметром ему передают информацию, которую нужно отправить пользователю, например, веб-страницу.

Скопировать кодJAVASCRIPT

```
app.get('/', (req, res) => {
  res.send(
        `<html>
        <body>
            <p>Ответ на сигнал из далёкого космоса</p>
        </body>
        </html>`
    );
}); 
```

Метод `send` может принимать разные данные в качестве аргумента:

Скопировать кодJAVASCRIPT

```
res.send('немного текста');
res.send('<p>немного html</p>');
res.send({ some: 'json' }); 
```

Кроме отправки ответа метод автоматически выставит заголовок Content-Type в соответствии с аргументом, который ему передали:

Скопировать кодJAVASCRIPT

```
res.send('немного текста'); //  Content-Type: text/plain
res.send('<p>немного html</p>'); //  Content-Type: text/plain
res.send({ some: 'json' }); //  Content-Type: application/json 
```

По умолчанию метод `send` отправляет ответ со статусом 200. Его можно изменить методом `status`:

Скопировать кодJAVASCRIPT

```
app.get('/', (req, res) => {
  res.status(404);
  res.send('<h1>Страница не найдена</h1>');
}); 
```

Метод `status` устроен так, что его и `send` можно использовать по цепочке. Обычно так и делают:

Скопировать кодJAVASCRIPT

```
app.get('/', (req, res) => {
  res.status(404).send('<h1>Страница не найдена</h1>');
}); 
```

Со статус-кодами вы познакомились [в этой теме](https://praktikum.yandex.ru/learn/web/courses/4da123a7-d4aa-4bc2-b299-b48f921da09c/sprints/2798/topics/5dc7307b-8486-40a5-b418-0888ac73337e/lessons/c0b00d3c-ac98-439a-b724-45efecfc896a/). Важно присваивать разным ошибкам соответствующие статус-коды. Это нужно для правильной работы любого приложения.

У объекта ответа есть и другие методы. Будем знакомиться с ними постепенно, но если что — [вот документация](http://expressjs.com/ru/api.html#res).

### Объект запроса

Запрос содержит информацию о том, что нужно пользователю. Она может быть организована по-разному, например, в GET-запросе данные пользователя «упакованы» в строку, которая хранится в свойстве query объекта запроса.

Скопировать кодJAVASCRIPT

```
app.get('/', (req, res) => {
  res.send(req.query);
}); 
```

В примере мы можем передавать любые данные в формате query string, сервер обработает их и пришлёт JSON-файл в виде строки.

### Обработка методов в express

В экспрессе есть методы для обработки любого запроса. Если хотите освежить их в памяти — [просмотрите этот урок](https://praktikum.yandex.ru/learn/web/courses/4da123a7-d4aa-4bc2-b299-b48f921da09c/sprints/2798/topics/5dc7307b-8486-40a5-b418-0888ac73337e/lessons/3164b264-9a7e-4100-838c-62480f73fd2d/). Они называются так же, как соответствующие HTTP-методы, и могут быть вызваны на приложении, где им в качестве параметров будут переданы эндпоинты и функции-обработчики:

Скопировать кодJAVASCRIPT

```
app.get('/books', getBooks);
app.post('/books', createBook);
app.put('/books', replaceBook);
app.patch('/books', updateBookInfo);
app.delete('/books', deleteBook); 
```